"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3119],{3119:(lt,A,c)=>{c.r(A),c.d(A,{ViewAllPageModule:()=>ot});var w=c(177),G=c(9417),v=c(8974),k=c(3021),u=c(467),p=c(56),L=c(4715),x=c(4733),B=c(1471),R=c(2849),S=c(9441),$=c(8666),Y=c(7420),j=c(5318),V=c.n(j),U=c(1129),X=c(8113),t=c(4438),E=c(444),I=c(2904),F=c(7803),N=c(4517),T=c(5402);const W=o=>({"createList-cards":o});function z(o,s){if(1&o&&t.nrm(0,"img",11),2&o){const i=t.XpG().$implicit;t.Y8G("src",null!=i&&null!=i.metaData&&i.metaData.thumbnail&&!i.metaData.identifier.startsWith("do_")?null==i||null==i.metaData?null:i.metaData.thumbnail:"assets/images/Audio.png",t.B4B)}}function J(o,s){if(1&o&&t.nrm(0,"img",11),2&o){const i=t.XpG().$implicit;t.Y8G("src",null!=i&&null!=i.metaData&&i.metaData.thumbnail&&!i.metaData.identifier.startsWith("do_")?null==i||null==i.metaData?null:i.metaData.thumbnail:"assets/images/youtube-video.png",t.B4B)}}function H(o,s){if(1&o&&t.nrm(0,"img",11),2&o){const i=t.XpG().$implicit;t.Y8G("src",null!=i&&null!=i.metaData&&i.metaData.thumbnail&&!i.metaData.identifier.startsWith("do_")?null==i||null==i.metaData?null:i.metaData.thumbnail:"assets/images/Video.png",t.B4B)}}function Q(o,s){if(1&o&&t.nrm(0,"img",11),2&o){const i=t.XpG().$implicit;t.Y8G("src",null!=i&&null!=i.metaData&&i.metaData.thumbnail&&!i.metaData.identifier.startsWith("do_")?null==i||null==i.metaData?null:i.metaData.thumbnail:"assets/images/PDF.png",t.B4B)}}function K(o,s){if(1&o&&t.nrm(0,"img",11),2&o){const i=t.XpG().$implicit;t.Y8G("src",null!=i&&null!=i.metaData&&i.metaData.thumbnail&&!i.metaData.identifier.startsWith("do_")?null==i||null==i.metaData?null:i.metaData.thumbnail:"assets/images/LINK.png",t.B4B)}}function Z(o,s){if(1&o&&(t.j41(0,"div",12),t.EFF(1),t.k0s()),2&o){const i=t.XpG().$implicit;t.R7$(),t.JRh(null==i||null==i.metaData?null:i.metaData.name)}}function q(o,s){if(1&o){const i=t.RV6();t.j41(0,"div",13),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$implicit,l=t.XpG();return t.Njj(l.openModal(n))}),t.nrm(1,"ion-icon",14),t.k0s()}}function tt(o,s){if(1&o){const i=t.RV6();t.j41(0,"div")(1,"ion-checkbox",15),t.bIt("ionChange",function(n){t.eBV(i);const l=t.XpG().index,r=t.XpG();return t.Njj(r.isContentSelect(n,l))}),t.k0s()()}if(2&o){const i=t.XpG().$implicit;t.R7$(),t.Y8G("checked",i.isSelected)}}function et(o,s){if(1&o){const i=t.RV6();t.j41(0,"div",4),t.bIt("click",function(){const n=t.eBV(i).$implicit,l=t.XpG();return t.Njj(l.playcontent(n))}),t.j41(1,"div",5),t.DNE(2,z,1,1,"img",6)(3,J,1,1,"img",6)(4,H,1,1,"img",6)(5,Q,1,1,"img",6)(6,K,1,1,"img",6),t.k0s(),t.j41(7,"div",7),t.DNE(8,Z,2,1,"div",8)(9,q,2,0,"div",9)(10,tt,2,1,"div",10),t.k0s()()}if(2&o){const i=s.$implicit,e=t.XpG();t.R7$(2),t.Y8G("ngIf",i.metaData.mimetype===e.mimeType.AUDIO),t.R7$(),t.Y8G("ngIf",i.metaData.mimetype===e.mimeType.YOUTUBE),t.R7$(),t.Y8G("ngIf",i.metaData.mimetype===e.mimeType.MP4),t.R7$(),t.Y8G("ngIf",i.metaData.mimetype===e.mimeType.PDF),t.R7$(),t.Y8G("ngIf",i.metaData.mimetype===e.mimeType.LINK),t.R7$(2),t.Y8G("ngIf",null==i||null==i.metaData?null:i.metaData.name),t.R7$(),t.Y8G("ngIf","recentlyviewed"===e.type),t.R7$(),t.Y8G("ngIf","playlist"===e.type)}}function nt(o,s){if(1&o){const i=t.RV6();t.j41(0,"div",16)(1,"div",17)(2,"div",18)(3,"div",19),t.EFF(4),t.k0s(),t.nrm(5,"ion-icon",20),t.k0s(),t.j41(6,"div",21),t.bIt("click",function(){t.eBV(i);const n=t.XpG();return t.Njj(n.uploadLocalContents())}),t.nrm(7,"ion-icon",22),t.k0s(),t.j41(8,"div",23)(9,"ion-button",24),t.bIt("click",function(){t.eBV(i);const n=t.XpG();return t.Njj(n.createList())}),t.EFF(10),t.nI1(11,"translate"),t.k0s()()()()}if(2&o){const i=t.XpG();t.R7$(4),t.JRh(i.selectedContents.length),t.R7$(5),t.Y8G("disabled",!i.selectedContents.length),t.R7$(),t.SpI(" ",t.bMT(11,3,"createPlaylist")," ")}}const it=[{path:"",component:(()=>{var o;class s{constructor(e,n,l,r,d,h,g,m){var C;this.contentService=e,this.router=n,this.headerService=l,this.playListService=r,this.platform=d,this.location=h,this.modalCtrl=g,this.utilService=m,this.contentList=[],this.type="",this.playlists=[],this.selectedContents=[],this.optModalOpen=!1,this.mimeType=p.Cc,this.resolveNativePath=y=>new Promise((D,_)=>{window.FilePath.resolveNativePath(y,D,b=>{console.error(`${y} could not be resolved by the plugin: ${b.message}`),_(b)})}),this.navigated=!1;let f=null===(C=this.router.getCurrentNavigation())||void 0===C?void 0:C.extras;var O;f&&(this.type=null===(O=f.state)||void 0===O?void 0:O.type)}ngOnInit(){var e=this;return(0,u.A)(function*(){e.platform.backButton.subscribeWithPriority(11,(0,u.A)(function*(){e.location.back(),e.headerService.deviceBackBtnEvent({name:"backBtn"})})),e.headerService.headerEventEmitted$.subscribe(n=>{"back"===n&&!e.navigated&&(e.navigated=!0,e.location.back())}),e.getRecentlyviewedContent()})()}getPlaylistContent(){var e=this;return(0,u.A)(function*(){yield e.playListService.getAllPlayLists("guest").then(n=>{n&&(e.playlists=n)}).catch(n=>{console.log("error",n)})})()}getRecentlyviewedContent(){var e=this;return(0,u.A)(function*(){yield e.contentService.getRecentlyViewedContent("guest").then(n=>{let l={};n.filter(r=>!l[r.contentIdentifier]&&(l[r.contentIdentifier]=!0,e.contentList.push(r),!0)),e.contentList.map(r=>r.metaData="string"==typeof r.metaData?JSON.parse(r.metaData):r.metaData),e.contentList=e.getContentImgPath(e.contentList)}).catch(n=>{console.log("error",n)})})()}ngOnDestroy(){var e=this;return(0,u.A)(function*(){const n=yield e.modalCtrl.getTop();n&&n.dismiss()})()}createList(){let e=[];this.contentList.forEach(n=>{n.isSelected&&e.push(n)}),console.log("...................",e),this.router.navigate(["/create-playlist"],{state:{selectedContents:e}})}deletePlaylist(){var e=this;return(0,u.A)(function*(){yield e.playListService.deletePlayList(e.deleteContent.identifier).then(n=>{e.getPlaylistContent()}).catch(n=>{console.log("err",n)})})()}ionViewWillEnter(){this.navigated=!1,"recentlyviewed"===this.type?this.headerService.showHeader("Recently Viewed",!0):"playlist"===this.type&&this.headerService.showHeader("Select from Recently Viewed",!0),this.getPlaylistContent()}openModal(e){var n=this;return(0,u.A)(function*(){let l;n.optModalOpen||(n.optModalOpen=!0,l=yield n.modalCtrl.create({component:R.q,componentProps:{content:e},cssClass:"sheet-modal",breakpoints:[.25],showBackdrop:!1,initialBreakpoint:.25,handle:!1,handleBehavior:"none"}),yield l.present()),l.onDidDismiss().then(function(){var r=(0,u.A)(function*(d){n.optModalOpen=!1,d.data&&"addToPitara"===d.data.type?n.addContentToMyPitara(d.data.content||e):d.data&&"like"==d.data.type&&(n.contentService.likeContent(d.data.content||e,"guest",!0),d.data.content.metaData.isLiked&&(yield $.Q.play({assetId:"windchime"}),(0,Y.A)({startVelocity:30,particleCount:400,spread:360,ticks:60,origin:{y:.5,x:.5},colors:["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a"]})))});return function(d){return r.apply(this,arguments)}}())})()}addContentToMyPitara(e){var n=this;return(0,u.A)(function*(){const l=yield n.modalCtrl.create({component:S.$,componentProps:{content:e},cssClass:"add-to-pitara",breakpoints:[0,1],showBackdrop:!1,initialBreakpoint:1,handle:!1,handleBehavior:"none"});yield l.present(),l.onWillDismiss().then(r=>{})})()}isContentSelect(e,n){this.contentList[n].isSelected=e.detail.checked,this.checkSelectedContent()}checkSelectedContent(){this.selectedContents=[],this.contentList.forEach(e=>{e.isSelected&&this.selectedContents.push(e)})}openFilePicker(){var e=this;return(0,u.A)(function*(){let n=[p.z5.PDF];n=n.concat(p.z5.VIDEOS).concat(p.z5.AUDIO);const{files:l}=yield L.N.pickFiles({types:n,multiple:!0,readData:!1});let r=[];const d=yield e.utilService.getLoader();yield d.present();for(let h=0;h<l.length;h++){const g=yield e.resolveNativePath(l[h].path);console.log("path",g);const m=g.substring(g.lastIndexOf("/")+1);r.push({source:"local",sourceType:"local",metaData:{identifier:(0,B.SHA1)(g).toString(),url:g,name:m,mimetype:x.O.getMimeType(m),thumbnail:""}})}yield d.dismiss(),r.length&&(r=e.getContentImgPath(r,!0),e.contentList=r.concat(e.contentList))})()}getContentImgPath(e,n){return e.forEach(l=>{var r;l.metaData.thumbnail=l.metaData.mimetype===p.Cc.YOUTUBE?l.metaData.thumbnail:!l.metaData.thumbnail||null!=l&&null!==(r=l.metaData.identifier)&&void 0!==r&&r.startsWith("do_")?x.O.getImagePath(l.metaData.mimetype||l.metaData.mimeType):l.mediaData.thumbnail,n&&(l.isSelected=!0,this.selectedContents.push(l))}),e}loadYoutubeImg(e){let n=e.identifier;return n&&n.startsWith("do_")&&(n=V()(e.url)),`https://img.youtube.com/vi/${n}/mqdefault.jpg`}playcontent(e){var n=this;return(0,u.A)(function*(){"recentlyviewed"===n.type&&!n.optModalOpen&&(yield n.router.navigate(["/player"],{state:{content:e}}))})()}uploadLocalContents(){var e=this;return(0,u.A)(function*(){let n;e.optModalOpen||(e.optModalOpen=!0,n=yield e.modalCtrl.create({component:U.W,componentProps:{uploadType:[{type:"url",label:"Upload from Youtube"},{type:"diksha",label:"Upload from Diksha"}]},cssClass:"sheet-modal",breakpoints:[.25],showBackdrop:!1,initialBreakpoint:.25,handle:!1,handleBehavior:"none"}),yield n.present()),n.onDidDismiss().then(function(){var l=(0,u.A)(function*(r){e.optModalOpen=!1,"file"===r.data.type?e.openFilePicker():e.createYoutubeContent(r.data.type)});return function(r){return l.apply(this,arguments)}}())})()}createYoutubeContent(e){var n=this;return(0,u.A)(function*(){const l=yield n.modalCtrl.create({component:X.r,componentProps:{title:"url"==e?"Add Youtube URL":"Add Diksha URL",placeholder:"Name"},cssClass:"auto-height"});yield l.present(),l.onDidDismiss().then(function(){var r=(0,u.A)(function*(d){var h;let g=null===(h=d.data)||void 0===h?void 0:h.url;if(d&&"create"===d.data.type){let m=[];const C=yield n.utilService.getLoader();yield C.present();let f="";if("url"===e)f=V()(g),m.push({source:"local",sourceType:"local",metaData:{identifier:f,url:"https://www.youtube.com/watch?v="+f,name:d.data.name,mimetype:p.z5.YOUTUBE,thumbnail:""}}),m=n.getContentImgPath(m,!0),n.contentList=m.concat(n.contentList);else if("diksha"===e){f=g.split("/").filter(y=>y.startsWith("do_"));try{yield n.contentService.readDikshaContents(f[0]).then(function(){var y=(0,u.A)(function*(D){var _,b;console.log("res ",D);let a=null===(_=D.body)||void 0===_||null===(_=_.result)||void 0===_?void 0:_.content;if((null===(b=a.dialcodes)||void 0===b?void 0:b.length)>0)yield n.contentService.getContents(a.dialcodes[0]).then(P=>{console.log("content data ",P),P.length>0&&(P.forEach(M=>{M.source="local",(M.metaData.mimetype==p.z5.PDF||M.metaData.mimetype==p.z5.VIDEO)&&m.push(M)}),m=n.getContentImgPath(m,!0),n.contentList=m.concat(n.contentList))});else if(a.mediaType="content"){let P={source:"local",sourceType:"diksha",metaData:{identifier:null==a?void 0:a.identifier,name:null==a?void 0:a.name,thumbnail:null==a?void 0:a.thumbnail,description:null==a?void 0:a.name,mimetype:(null==a?void 0:a.mimetype)||(null==a?void 0:a.mimeType),url:null==a?void 0:a.streamingUrl,focus:null==a?void 0:a.focus,keyword:null==a?void 0:a.keyword,domain:null==a?void 0:a.domain,curriculargoal:null==a?void 0:a.curriculargoal,competencies:null==a?void 0:a.competencies,language:null==a?void 0:a.language,category:null==a?void 0:a.category,audience:null==a?void 0:a.audience,status:null==a?void 0:a.status,createdon:null==a?void 0:a.createdOn,lastupdatedon:(null==a?void 0:a.lastupdatedon)||(null==a?void 0:a.lastUpdatedOn),artifactUrl:null==a?void 0:a.artifactUrl}};(P.metaData.mimetype==p.z5.PDF||P.metaData.mimetype==p.z5.VIDEO)&&(m.push(P),m=n.getContentImgPath(m,!0),n.contentList=m.concat(n.contentList))}});return function(D){return y.apply(this,arguments)}}())}catch(y){console.log("server err ",y)}}yield C.dismiss()}});return function(d){return r.apply(this,arguments)}}())})()}}return(o=s).\u0275fac=function(e){return new(e||o)(t.rXU(E.f),t.rXU(k.Ix),t.rXU(I.Ux),t.rXU(F.q),t.rXU(N.OD),t.rXU(w.aZ),t.rXU(v.W3),t.rXU(I.a0))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-view-all"]],viewQuery:function(e,n){if(1&e&&t.GBs(v.Sb,5),2&e){let l;t.mGM(l=t.lsd())&&(n.modal=l.first)}},decls:4,vars:6,consts:[[3,"fullscreen"],[1,"cards-container",3,"ngClass"],["class","card",3,"click",4,"ngFor","ngForOf"],["class","view-all-btn",4,"ngIf"],[1,"card",3,"click"],[1,"card__img"],["alt","",3,"src",4,"ngIf"],[1,"card__metadata"],["class","card__title",4,"ngIf"],[3,"click",4,"ngIf"],[4,"ngIf"],["alt","",3,"src"],[1,"card__title"],[3,"click"],["slot","end","aria-hidden","true","src","../../../assets/icon/kabab-icon.svg"],[1,"playlist-card__checkbox",3,"ionChange","checked"],[1,"view-all-btn"],[1,"view-playlist"],[1,"view-playlist__icon"],[1,"count"],["aria-hidden","true","src","assets/icon/pitara-blue.svg"],[1,"view-playlist__icon",3,"click"],["aria-hidden","true","src","assets/icon/file-upload.svg"],[1,"view-playlist__button"],["fill","outline",1,"new-playlist__btn",3,"click","disabled"]],template:function(e,n){1&e&&(t.j41(0,"ion-content",0)(1,"div",1),t.DNE(2,et,11,8,"div",2),t.k0s()(),t.DNE(3,nt,12,5,"div",3)),2&e&&(t.Y8G("fullscreen",!0),t.R7$(),t.Y8G("ngClass",t.eq3(4,W,"playlist"===n.type)),t.R7$(),t.Y8G("ngForOf",n.contentList),t.R7$(),t.Y8G("ngIf","playlist"===n.type))},dependencies:[w.YU,w.Sq,w.bT,v.Jm,v.eY,v.W9,v.iq,v.hB,T.D9],styles:[".cards-container[_ngcontent-%COMP%]{padding:.2rem 1rem}.cards-container[_ngcontent-%COMP%]   .bot-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0 1rem 1rem}.cards-container[_ngcontent-%COMP%]   .bot-section[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.cards-container[_ngcontent-%COMP%]   .bot-section[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .image-title[_ngcontent-%COMP%]{position:absolute;bottom:.625rem;color:var(--ion-color-primary-contrast);left:0;right:0;text-align:center}.card[_ngcontent-%COMP%]{position:relative;padding-bottom:1rem}.card__img[_ngcontent-%COMP%]{height:194px;width:100%;overflow:hidden}.card__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;border-radius:1rem}.card__metadata[_ngcontent-%COMP%]{padding-top:.5rem;display:flex;align-items:center;justify-content:space-between}.card__metadata[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{height:1.75rem;width:1.75rem}.card__action-btns[_ngcontent-%COMP%]{display:flex;align-items:center}.card__action-btns[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;margin-right:1rem}.card__action-btns[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]:last-child{margin-left:auto;margin-right:0}.card__title[_ngcontent-%COMP%]{font-size:.75rem;font-weight:400;width:90%;text-transform:capitalize;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.no-data[_ngcontent-%COMP%]{text-align:center}.cards-container[_ngcontent-%COMP%]{padding-top:.5rem}.card[_ngcontent-%COMP%]{display:flex}.card__img[_ngcontent-%COMP%]{width:100%;height:4.5rem;max-width:7.5rem}.card__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:.5rem}.card__metadata[_ngcontent-%COMP%]{padding-top:0;padding-left:.5rem;align-items:flex-start;width:100%}.view-playlist[_ngcontent-%COMP%]{position:fixed;bottom:.188rem;width:98%;height:4rem;background-color:var(--ion-color-secondary);border-radius:3.125rem;display:flex;align-items:center;padding:.5rem}.view-playlist__icon[_ngcontent-%COMP%]{width:3rem;height:3rem;background-color:var(--ion-color-primary-contrast);border-radius:50%;display:flex;align-items:center;justify-content:center;position:relative;margin-right:5%}.view-playlist__icon[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{position:absolute;top:-.188rem;right:-.188rem;background:var(--ion-color-primary);border-radius:50%;font-size:.625rem;width:1.125rem;height:1.125rem;display:flex;align-items:center;justify-content:center;color:var(--ion-color-primary-contrast)}.view-playlist__icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem}.view-playlist__button[_ngcontent-%COMP%]{margin-left:auto}.view-playlist__button[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{font-size:.75rem;font-weight:700}.view-all-btn[_ngcontent-%COMP%]{display:flex;justify-content:center}[_nghost-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{--border-radius: 50% !important;--border-color: var(--ion-color-medium) !important;--size: 1.5rem !important;--checkbox-background-checked: var(--ion-color-secondary) !important;--border-color-checked: var(--ion-color-secondary) !important;margin:0}[_nghost-%COMP%]   ion-button.new-playlist__btn[_ngcontent-%COMP%]{--background: var(--ion-color-secondary);--color: var(--ion-color-primary-contrast);--border-radius: 1.875rem;--border-color: var(--ion-color-primary-contrast);--border-style: solid;--border-width: 1px;--box-shadow: none}ion-content[_ngcontent-%COMP%]{--padding-top: 3.2rem}.createList-cards[_ngcontent-%COMP%]{height:calc(100vh - 120px);overflow:auto}"]}),s})()}];let at=(()=>{var o;class s{}return(o=s).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[k.iI.forChild(it),k.iI]}),s})(),ot=(()=>{var o;class s{}return(o=s).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[w.MD,G.YN,v.bv,at,T.h]}),s})()}}]);